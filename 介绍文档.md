# 项目需求与实现细节文档

## 项目概述
本项目旨在基于大模型驱动，构建一个能够根据用户提供的多种信息素材（如 PDF、DOC、PPT、网页等）生成知识图谱的系统。知识图谱作为大模型的知识库，支持用户进行可控且可信的问答交互。系统需支持轻量化本地部署，同时具备良好的扩展性和未来平台化能力。

---

## 核心功能模块

### 1. 文件处理模块
#### 功能描述
- 支持多种格式文件的上传与解析，包括但不限于：PDF、DOC、PPT、网页等。
- 将文件内容转化为 Markdown 格式，保留原始文件的基本格式和结构。
- 对文件内容进行分段处理，支持大文件的自动分割与合并结果。

#### 实现细节
- **文件上传**：
  - 支持批量上传，用户可一次性选择多个文件。
  - 上传后文件存储至后端指定目录，生成唯一标识符（UUID）用于后续处理。
- **文件解析**：
  - 使用开源工具（如 `pdf2md`、`unoconv`）完成格式转 Markdown 的转换。
  - 针对不同文件类型设计适配器模式，统一解析流程。
  - 提供文件解析状态查询接口，支持异步处理。
- **分段与结构化**：
  - 基于文件内容的自然段落或逻辑结构进行分段处理。
  - 可选支持去重、去噪等预处理功能（后续扩展）。

---

### 2. 知识图谱模块
#### 功能描述
- 从文件内容中提取实体与关系，生成知识图谱。
- 支持知识图谱的上下文关联、推理扩展以及图谱对齐与合并。
- 提供交互式知识图谱展示功能，支持搜索与索引。

#### 实现细节
- **实体与关系提取**：
  - 使用大模型（如 ChatGLM-6B 或 BELLE）对文件内容进行语义分析，提取实体和关系。
  - 通过正则表达式或预定义规则进一步优化提取结果。
- **知识图谱生成**：
  - 生成符合图数据库（如 Neo4j）或 JSON 格式的图谱数据。
  - 数据结构设计：
    ```json
    {
      "nodes": [
        {"id": "1", "label": "实体1", "type": "类型A"},
        {"id": "2", "label": "实体2", "type": "类型B"}
      ],
      "edges": [
        {"source": "1", "target": "2", "label": "关系类型"}
      ]
    }
    ```
- **知识图谱存储**：
  - 初期使用 JSON 文件存储，后续可扩展至图数据库（如 Neo4j）。
- **可视化展示**：
  - 前端使用 D3.js 或 Cytoscape.js 实现交互式图谱展示。
  - 支持节点点击查看详情、关系高亮、搜索定位等功能。

---

### 3. 问答交互模块
#### 功能描述
- 基于知识图谱和大模型实现用户可控、可信的问答交互。
- 支持上下文关联和知识库检索，提供准确且可解释的答案。

#### 实现细节
- **问答流程**：
  1. 用户输入问题。
  2. 系统检索知识图谱，获取相关实体和关系。
  3. 调用大模型进行推理，结合知识库生成答案。
- **知识库检索**：
  - 使用向量化检索（如 FAISS）对知识图谱或文件内容进行高效查询。
  - 检索结果作为大模型的上下文输入。
- **问答生成**：
  - 调用大模型 API，输入问题和检索结果，生成自然语言答案。
  - 提供答案的可信度评分和相关知识图谱节点的引用。

---

### 4. 前端模块
#### 功能描述
- 提供现代化、美观的用户界面，支持文件上传、知识图谱展示和问答交互功能。

#### 实现细节
- **文件上传界面**：
  - 支持拖拽上传和多文件选择。
  - 显示文件上传进度和解析状态。
- **知识图谱展示界面**：
  - 动态加载知识图谱数据，支持节点和关系的交互操作。
  - 提供搜索框，快速定位特定实体或关系。
- **问答交互界面**：
  - 用户输入问题后，显示系统生成的答案和相关知识图谱引用。
  - 支持答案的上下文展开查看。

---

### 5. 后端模块
#### 功能描述
- 提供文件处理、知识图谱生成、问答交互等核心功能的 API 接口。
- 支持 Swagger 文档生成，便于测试和调试。

#### 实现细节
- **技术选型**：
  - 使用 Python（FastAPI）或 Node.js（Express）开发后端服务。
  - 数据存储：初期使用 JSON 文件，后续扩展至 PostgreSQL 或 Neo4j。
- **API 设计**：
  - 文件上传与解析：
    - `POST /upload`：上传文件。
    - `GET /status/{file_id}`：查询解析状态。
  - 知识图谱生成与查询：
    - `POST /generate-graph`：生成知识图谱。
    - `GET /graph/{graph_id}`：获取知识图谱数据。
  - 问答交互：
    - `POST /qa`：提交问题，返回答案和相关知识图谱引用。
- **模块化设计**：
  - 文件处理、知识图谱生成、问答交互等功能模块独立部署，便于维护与扩展。

---

## 技术选型与工具
| 模块             | 技术/工具                 | 说明                                   |
|------------------|--------------------------|--------------------------------------|
| 大模型           | ChatGLM-6B, BELLE        | 中文优化，支持本地部署。               |
| 文件解析         | pdf2md, unoconv          | 开源工具，支持多格式文件解析。         |
| 知识图谱存储     | JSON, Neo4j              | 初期使用 JSON，后续扩展至图数据库。   |
| 知识图谱可视化   | D3.js, Cytoscape.js      | 实现交互式图谱展示。                   |
| 前端框架         | React.js, Ant Design     | 提供现代化 UI 和组件库支持。           |
| 后端框架         | FastAPI, Node.js         | 提供高效的 API 服务。                  |
| 数据存储         | JSON, PostgreSQL         | 文件与知识图谱数据的存储方案。         |

---

## 扩展性与未来规划
- **多语言支持**：
  - 可通过大模型扩展或接入翻译服务实现。
- **外部数据源接入**：
  - 支持接入开放数据集或第三方知识库，丰富知识图谱内容。
- **平台化上线**：
  - 增加用户管理、权限控制等功能，支持多用户使用。
- **性能优化**：
  - 引入缓存机制，加速文件解析与问答响应。
  - 使用云端算力提升大模型推理效率。

---

## 总结
本项目通过文件处理、知识图谱生成和问答交互模块的协同工作，实现了基于大模型驱动的知识图谱构建与问答系统。系统设计注重轻量化本地部署，具备良好的扩展性，能够满足未来平台化需求。

